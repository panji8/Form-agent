<!doctype html>
<html lang="id">
<head>
  <meta charset="utf-8" />
  <title>Form Order - SuruhBoy</title>
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <link rel="stylesheet" href="style.css" />
</head>

<body>
  <div class="container">
    <h2>Form Order</h2>

    <form id="orderForm">

      <label>ğŸ“¦ Biaya</label>
      <input type="text" name="biaya" required />

      <label>ğŸ“† Kapan</label>
      <!-- DIGANTI: DATE PICKER -->
      <input type="date" name="kapan" required />

      <label>ğŸ‘¤ Nama</label>
      <input type="text" name="nama" required />

      <label>ğŸ“± HP</label>
      <input type="text" name="hp" required />

      <label>ğŸ“ Deskripsi</label>
      <textarea name="deskripsi"></textarea>

      <label>ğŸ“ Jemput</label>
      <input type="text" name="jemput" />

      <label>ğŸ“ Antar</label>
      <input type="text" name="antar" />

      <label>ğŸ§‘â€ğŸ’¼ Agent</label>
      <input type="text" name="agent" />

      <button type="submit" id="submitBtn">SUBMIT</button>
    </form>

    <!-- TEMPAT TEMPLATE MUNCUL -->
    <div id="resultBox" style="display:none; margin-top:20px;">
      <h3>Template Order:</h3>
      <pre id="templateOutput"></pre>
    </div>
  </div>

  <script>
    const form = document.getElementById("orderForm");
    const submitBtn = document.getElementById("submitBtn");

    form.addEventListener("submit", async (e) => {
      e.preventDefault();

      // POPUP SEDANG MENGIRIM DATA
      alert("Sedang mengirim data...");

      submitBtn.disabled = true;
      submitBtn.textContent = "Mengirim...";

      const formData = new FormData(form);

      try {
        const response = await fetch(
          "https://script.google.com/macros/s/AKfycbwaxxAA-_gJKxn6yP484HPrGgy5XZSwkhTGBe3dHYLm-Svssn4WM1EzDW1BYIHzRqXy/exec",
          {
            method: "POST",
            body: formData,
          }
        );

        if (response.ok) {
          alert("Berhasil tersimpan!"); // POPUP BERHASIL

          form.reset(); // Kosongkan form

          // generate template lokal (tanpa redirect)
          const template = `ğŸŸ¦ ORDER MASUK

ğŸ“¦ Biaya: ${formData.get("biaya")}
ğŸ“… Kapan: ${formData.get("kapan")}
ğŸ‘¤ Nama: ${formData.get("nama")}
ğŸ“± https://wa.me/${formData.get("hp")}
ğŸ“ Deskripsi: ${formData.get("deskripsi") || "-"}
ğŸ“ Jemput: ${formData.get("jemput") || "-"}
ğŸ“ Antar: ${formData.get("antar") || "-"}
ğŸ§‘â€ğŸ’¼ Agent: ${formData.get("agent") || "-"}`;

  // Tampilkan template
  document.getElementById("templateBox").textContent = template;
  document.getElementById("resultCard").style.display = "block";

  // Link ke grup
  document.getElementById("chatBtn").href =
    "https://chat.whatsapp.com/DlIfRxaICuRCXc1ZndEDTc";

  // Reset form
  this.reset();
});

// Tombol copy
document.getElementById("copyBtn").addEventListener("click", async () => {
  try {
    await navigator.clipboard.writeText(
      document.getElementById("templateBox").textContent
    );
    copyBtn.textContent = "âœ” TERSALIN!";
    copyBtn.style.background = "#1e7c33";

    setTimeout(() => {
      copyBtn.textContent = "COPY TEMPLATE";
      copyBtn.style.background = "#28a745";
    }, 1500);
  } catch (err) {
    alert("Gagal menyalin!");
  }

      submitBtn.disabled = false;
      submitBtn.textContent = "SUBMIT";
    });
  </script>
</body>
</html>

