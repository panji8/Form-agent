<script>
  const params = new URLSearchParams(window.location.search);
  const template = params.get("template");

  if (!template) {
    window.location.href = "index.html";
  }

  document.getElementById("templateBox").textContent =
    decodeURIComponent(template);

  const groupLink = "https://chat.whatsapp.com/DlIfRxaICuRCXc1ZndEDTc";
  const chatBtn = document.getElementById("chatBtn");

  if (chatBtn) {
    chatBtn.addEventListener("click", function (e) {
      const isAndroid = /Android/i.test(navigator.userAgent);

      if (isAndroid) {
        e.preventDefault();

        const groupCode = groupLink.replace(
          "https://chat.whatsapp.com/",
          ""
        );

        const waBusinessIntent =
          "intent://chat.whatsapp.com/" +
          groupCode +
          "#Intent;package=com.whatsapp.w4b;scheme=https;end";

        window.location.href = waBusinessIntent;
      } else {
        // iPhone & desktop → WA normal
        window.location.href = groupLink;
      }
    });
  }

  // COPY BUTTON (ASLI)
  const copyBtn = document.getElementById("copyBtn");

  copyBtn.addEventListener("click", async () => {
    try {
      await navigator.clipboard.writeText(
        document.getElementById("templateBox").textContent
      );

      copyBtn.textContent = "✔ TERSALIN!";
      copyBtn.style.background = "#1e7c33";

      setTimeout(() => {
        copyBtn.textContent = "COPY TEMPLATE";
        copyBtn.style.background = "#28a745";
      }, 1500);

    } catch (err) {
      alert("Gagal menyalin template!");
    }
  });
</script>
